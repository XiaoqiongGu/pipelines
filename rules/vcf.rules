"""Rules to bgzip and index vcf files

Requires htslib
"""


rule bgzip:
    input:
        vcf = "{prefix}.vcf"
    output:
        bgzip = "{prefix}.vcf.gz"
    log:
        "{prefix}.vcf.gz.log"
    threads:
        2
    shell:
        "bgzip -@ {threads} {input.vcf} >& {log}"

        
rule tabix:
    input:
        "{prefix}.vcf.gz"
    output:
        "{prefix}.vcf.gz.tbi"
    log:
        "{prefix}.vcf.gz.tbi.log"
    shell:
        "tabix -f -p vcf {input} >& {log}"
    
